import{u as L,r as s,j as e,X as z}from"./index-CgAID_vQ.js";const l=4e3,A=4e3,u=6e3,P=l+A+u,S=6e4;function U(t){return t==="inhale"||t==="hold"?170:90}function T(t){return t==="inhale"?`width ${l}ms cubic-bezier(0.25,0.46,0.45,0.94),
            height ${l}ms cubic-bezier(0.25,0.46,0.45,0.94),
            box-shadow ${l}ms ease`:t==="exhale"?`width ${u}ms cubic-bezier(0.25,0.46,0.45,0.94),
            height ${u}ms cubic-bezier(0.25,0.46,0.45,0.94),
            box-shadow ${u}ms ease`:"width 300ms ease, height 300ms ease, box-shadow 300ms ease"}function _(t){return t==="inhale"||t==="hold"?"0 0 60px hsl(var(--primary) / 0.45), 0 0 120px hsl(var(--primary) / 0.2), inset 0 0 40px hsl(var(--primary) / 0.1)":"0 0 20px hsl(var(--primary) / 0.15), 0 0 40px hsl(var(--primary) / 0.07)"}const F=({onClose:t})=>{const{t:r}=L(),[n,h]=s.useState("idle"),[C,f]=s.useState(0),[d,$]=s.useState(!1),[D,x]=s.useState(60),[p,v]=s.useState(0),b=s.useRef(null),o=s.useRef(null),g=s.useRef("idle"),m=s.useCallback(()=>{o.current!==null&&(cancelAnimationFrame(o.current),o.current=null)},[]),y=s.useCallback(()=>{if(b.current===null)return;const j=Date.now()-b.current;if(j>=S){h("done"),f(1),x(0);return}const k=j/S;f(k),x(Math.ceil((1-k)*60));const R=j%P;let i;R<l?i="inhale":R<l+A?i="hold":i="exhale",i!==g.current&&(g.current=i,v(O=>O+1)),h(i),o.current=requestAnimationFrame(y)},[]),N=s.useCallback(()=>{m(),g.current="inhale",$(!0),h("inhale"),f(0),x(60),v(1),b.current=Date.now(),o.current=requestAnimationFrame(y)},[y,m]);s.useEffect(()=>()=>m(),[m]);const w=2*Math.PI*56,E=w*(1-C),a=U(n),c=n!=="idle"&&n!=="done"?n:null,I=n==="inhale"?"hsl(var(--primary))":n==="hold"?"hsl(var(--accent-foreground))":"hsl(var(--muted-foreground))";return e.jsxs("div",{className:"py-16 px-6 bg-background animate-fade-in",children:[e.jsxs("div",{className:"max-w-sm mx-auto text-center",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsx("button",{onClick:t,className:"text-muted-foreground hover:text-foreground transition-colors","aria-label":"Close",children:e.jsx(z,{className:"w-4 h-4"})})}),e.jsxs("p",{className:"text-primary font-medium tracking-widest uppercase text-xs mb-1",children:["ðŸŒ¿ ",r("mindfulness.label")]}),e.jsx("h3",{className:"font-heading text-2xl text-foreground mb-2",children:r("mindfulness.title")}),e.jsx("p",{className:"text-muted-foreground text-sm mb-10",children:r("mindfulness.subtitle")}),e.jsx("div",{className:"h-12 flex items-center justify-center mb-2",children:c&&e.jsx("span",{className:"font-heading text-3xl font-semibold animate-fade-in",style:{color:I,letterSpacing:"0.04em"},children:r(`mindfulness.${c}`)},`label-${c}-${p}`)}),e.jsxs("div",{className:"relative flex items-center justify-center mb-10",style:{height:230},children:[e.jsxs("svg",{className:"absolute",width:"140",height:"140",viewBox:"0 0 140 140",style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{cx:"70",cy:"70",r:"56",fill:"none",stroke:"hsl(var(--border))",strokeWidth:"2"}),d&&e.jsx("circle",{cx:"70",cy:"70",r:"56",fill:"none",stroke:"hsl(var(--primary))",strokeWidth:"2.5",strokeDasharray:w,strokeDashoffset:E,strokeLinecap:"round",style:{transition:"stroke-dashoffset 0.2s linear"}})]}),d&&c&&e.jsx("div",{className:"absolute rounded-full pointer-events-none",style:{width:a,height:a,border:"2px solid hsl(var(--primary) / 0.4)",animation:"mindful-ripple 2s ease-out forwards"}},`ripple-${p}`),d&&c&&e.jsx("div",{className:"absolute rounded-full pointer-events-none",style:{width:a,height:a,border:"1px solid hsl(var(--primary) / 0.2)",animation:"mindful-ripple 2s ease-out 0.5s forwards"}},`ripple2-${p}`),e.jsx("div",{className:"rounded-full bg-primary/15 border border-primary/25 flex items-center justify-center",style:{width:a,height:a,transition:T(n),boxShadow:_(n)},children:e.jsx("div",{className:"rounded-full bg-primary/40",style:{width:a*.35,height:a*.35,transition:T(n),boxShadow:"0 0 20px hsl(var(--primary) / 0.6)"}})})]}),n==="done"?e.jsxs("div",{className:"animate-fade-in space-y-4",children:[e.jsx("p",{className:"text-3xl",children:r("mindfulness.doneEmoji")}),e.jsx("p",{className:"font-heading text-xl text-foreground",children:r("mindfulness.doneTitle")}),e.jsx("p",{className:"text-muted-foreground text-sm leading-relaxed",children:r("mindfulness.doneText")}),e.jsx("button",{onClick:N,className:"mt-4 px-8 py-3 rounded-full bg-primary text-primary-foreground text-sm font-medium hover:bg-primary/90 transition-colors",children:r("mindfulness.restart")})]}):d?e.jsx("p",{className:"text-muted-foreground text-xs tracking-widest uppercase",children:r("mindfulness.remaining",{seconds:D})}):e.jsx("button",{onClick:N,className:"px-8 py-3 rounded-full bg-primary text-primary-foreground text-sm font-medium hover:bg-primary/90 transition-colors",children:r("mindfulness.begin")})]}),e.jsx("style",{children:`
        @keyframes mindful-ripple {
          0%   { transform: scale(1);   opacity: 0.7; }
          100% { transform: scale(2.2); opacity: 0;   }
        }
      `})]})};export{F as default};
