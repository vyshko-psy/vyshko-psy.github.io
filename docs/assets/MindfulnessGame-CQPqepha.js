import{u as L,r as s,j as e,X as P}from"./index-Bt4rmMqf.js";const l=4e3,T=4e3,m=6e3,M=l+T+m,w=6e4;function U(n){return n==="inhale"||n==="hold"?170:90}function R(n){return n==="inhale"?`width ${l}ms cubic-bezier(0.25,0.46,0.45,0.94),
            height ${l}ms cubic-bezier(0.25,0.46,0.45,0.94),
            box-shadow ${l}ms ease`:n==="exhale"?`width ${m}ms cubic-bezier(0.25,0.46,0.45,0.94),
            height ${m}ms cubic-bezier(0.25,0.46,0.45,0.94),
            box-shadow ${m}ms ease`:"width 300ms ease, height 300ms ease, box-shadow 300ms ease"}function _(n){return n==="inhale"||n==="hold"?"0 0 60px hsl(var(--primary) / 0.45), 0 0 120px hsl(var(--primary) / 0.2), inset 0 0 40px hsl(var(--primary) / 0.1)":"0 0 20px hsl(var(--primary) / 0.15), 0 0 40px hsl(var(--primary) / 0.07)"}const H=({onClose:n})=>{const{t}=L(),[r,h]=s.useState("idle"),[B,x]=s.useState(0),[u,A]=s.useState(!1),[D,p]=s.useState(60),[b,k]=s.useState(0),[I,O]=s.useState(0),[z,E]=s.useState(0),y=s.useRef(null),c=s.useRef(null),g=s.useRef("idle"),f=s.useCallback(()=>{c.current!==null&&(cancelAnimationFrame(c.current),c.current=null)},[]),j=s.useCallback(()=>{if(y.current===null)return;const d=Date.now()-y.current;if(d>=w){const N=t("mindfulness.quotes",{returnObjects:!0});E(Math.floor(Math.random()*N.length)),h("done"),x(1),p(0);return}const $=d/w;x($),p(Math.ceil((1-$)*60));const C=d%M;let o;C<l?o="inhale":C<l+T?o="hold":o="exhale",o!==g.current&&(g.current=o,k(N=>N+1)),h(o),c.current=requestAnimationFrame(j)},[]),S=s.useCallback(()=>{f(),g.current="inhale",A(!0),h("inhale"),x(0),p(60),k(1),O(d=>d+1),y.current=Date.now(),c.current=requestAnimationFrame(j)},[j,f]);s.useEffect(()=>()=>f(),[f]);const v=2*Math.PI*56,a=U(r),i=r!=="idle"&&r!=="done"?r:null,q=r==="inhale"?"hsl(var(--primary))":r==="hold"?"hsl(var(--accent-foreground))":"hsl(var(--muted-foreground))";return e.jsxs("div",{className:"py-8 px-6 bg-background animate-fade-in",children:[e.jsxs("div",{className:"max-w-sm mx-auto text-center",children:[e.jsx("div",{className:"flex justify-end mb-1",children:e.jsx("button",{onClick:n,className:"text-muted-foreground hover:text-foreground transition-colors","aria-label":"Close",children:e.jsx(P,{className:"w-4 h-4"})})}),e.jsxs("p",{className:"text-primary font-medium tracking-widest uppercase text-xs mb-1",children:["ðŸŒ¿ ",t("mindfulness.label")]}),e.jsx("h3",{className:"font-heading text-2xl text-foreground mb-1",children:t("mindfulness.title")}),e.jsx("p",{className:"text-muted-foreground text-sm mb-5",children:t("mindfulness.subtitle")}),e.jsx("div",{className:"h-10 flex items-center justify-center mb-1",children:i&&e.jsx("span",{className:"font-heading text-3xl font-semibold",style:{color:q,letterSpacing:"0.04em",display:"inline-block",animation:i==="inhale"?`mindful-text-in ${l}ms cubic-bezier(0.25,0.46,0.45,0.94) forwards`:i==="exhale"?`mindful-text-out ${m}ms cubic-bezier(0.25,0.46,0.45,0.94) forwards`:"mindful-fade-in 0.4s ease forwards"},children:t(`mindfulness.${i}`)},`label-${i}-${b}`)}),e.jsxs("div",{className:"relative flex items-center justify-center mb-5",style:{height:200},children:[e.jsxs("svg",{className:"absolute",width:"140",height:"140",viewBox:"0 0 140 140",style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{cx:"70",cy:"70",r:"56",fill:"none",stroke:"hsl(var(--border))",strokeWidth:"2"}),u&&e.jsx("circle",{cx:"70",cy:"70",r:"56",fill:"none",stroke:"hsl(var(--primary))",strokeWidth:"2.5",strokeDasharray:v,strokeDashoffset:v,strokeLinecap:"round",style:{animation:`mindful-progress ${w}ms linear forwards`}},`ring-${I}`)]}),u&&i&&e.jsx("div",{className:"absolute rounded-full pointer-events-none",style:{width:a,height:a,border:"2px solid hsl(var(--primary) / 0.4)",animation:"mindful-ripple 2s ease-out forwards"}},`ripple-${b}`),u&&i&&e.jsx("div",{className:"absolute rounded-full pointer-events-none",style:{width:a,height:a,border:"1px solid hsl(var(--primary) / 0.2)",animation:"mindful-ripple 2s ease-out 0.5s forwards"}},`ripple2-${b}`),e.jsx("div",{className:"rounded-full bg-primary/15 border border-primary/25 flex items-center justify-center",style:{width:a,height:a,transition:R(r),boxShadow:_(r)},children:r==="done"?e.jsxs("button",{onClick:S,className:"animate-fade-in rounded-full bg-primary text-primary-foreground text-xs font-medium hover:bg-primary/90 transition-colors flex flex-col items-center justify-center gap-0.5",style:{width:a*.75,height:a*.75},children:[e.jsx("span",{className:"text-lg leading-none",children:"â†º"}),e.jsx("span",{children:t("mindfulness.restart")})]}):e.jsx("div",{className:"rounded-full bg-primary/40",style:{width:a*.35,height:a*.35,transition:R(r),boxShadow:"0 0 20px hsl(var(--primary) / 0.6)"}})})]}),r==="done"?e.jsxs("div",{className:"animate-fade-in space-y-3",children:[e.jsx("p",{className:"text-3xl",children:t("mindfulness.doneEmoji")}),e.jsx("p",{className:"font-heading text-xl text-foreground",children:t("mindfulness.doneTitle")}),e.jsx("p",{className:"text-muted-foreground text-sm leading-relaxed",children:t("mindfulness.doneText")}),e.jsxs("div",{className:"pt-3 border-t border-border",children:[e.jsx("p",{className:"font-heading text-base text-foreground/80 italic leading-relaxed",children:t("mindfulness.quotes",{returnObjects:!0})[z]}),e.jsxs("p",{className:"text-primary text-xs font-medium tracking-wider uppercase mt-2",children:["â€” ",t("mindfulness.quoteAuthor")]})]})]}):u?e.jsx("p",{className:"text-muted-foreground text-xs tracking-widest uppercase",children:t("mindfulness.remaining",{seconds:D})}):e.jsx("button",{onClick:S,className:"px-8 py-3 rounded-full bg-primary text-primary-foreground text-sm font-medium hover:bg-primary/90 transition-colors",children:t("mindfulness.begin")})]}),e.jsx("style",{children:`
        @keyframes mindful-progress {
          from { stroke-dashoffset: ${v}; }
          to   { stroke-dashoffset: 0; }
        }
        @keyframes mindful-ripple {
          0%   { transform: scale(1);   opacity: 0.7; }
          100% { transform: scale(2.2); opacity: 0;   }
        }
        @keyframes mindful-text-in {
          0%   { transform: scale(0.75); opacity: 0.4; }
          100% { transform: scale(1.22); opacity: 1;   }
        }
        @keyframes mindful-text-out {
          0%   { transform: scale(1.22); opacity: 1;   }
          100% { transform: scale(0.75); opacity: 0.4; }
        }
        @keyframes mindful-fade-in {
          0%   { opacity: 0; transform: scale(0.95); }
          100% { opacity: 1; transform: scale(1);    }
        }
      `})]})};export{H as default};
